{% set implantacao = implantacao if implantacao is defined else {} %}
<div class="modal fade" id="modalDetalhesEmpresa" tabindex="-1" aria-labelledby="modalDetalhesEmpresaLabel"
    aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content" style="background-color: var(--container-bg); color: var(--body-color);">
            <div class="modal-header header-bg">
                <h5 class="modal-title" id="modalDetalhesEmpresaLabel" style="color: var(--body-color);">
                    <i class="bi bi-building me-2"></i>Resumo da Empresa
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form action="{{ url_for('actions.atualizar_detalhes_empresa') }}" method="POST">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                <div class="modal-body">
                    <input type="hidden" id="modal-implantacao_id" name="implantacao_id" value="">
                    <input type="hidden" name="redirect_to" id="modal-redirect_to" value="dashboard">

                    <!-- Empresa (Nome) - Readonly, apenas para exibição -->
                    <div class="mb-3">
                        <label for="modal-nome_empresa" class="form-label fw-bold">
                            <i class="bi bi-building text-primary me-1"></i>Empresa
                        </label>
                        <input type="text" class="form-control-plaintext fw-bold fs-5" id="modal-nome_empresa" readonly
                            value="">
                    </div>

                    <!-- Status -->
                    <div class="mb-3">
                        <label for="modal-status_implantacao" class="form-label fw-bold">
                            <i class="bi bi-flag text-primary me-1"></i>Status
                        </label>
                        <input type="text" class="form-control" id="modal-status_implantacao"
                            name="status_implantacao_oamd" value="{{ implantacao.status_implantacao_oamd or '' }}">
                    </div>

                    <!-- Data de Início -->
                    <div class="mb-3">
                        <label for="modal-inicio_efetivo" class="form-label fw-bold">
                            <i class="bi bi-calendar-event text-primary me-1"></i>Data de Início
                        </label>
                        <div class="input-group">
                            <input type="text" class="form-control date-mask custom-datepicker no-datepicker"
                                id="modal-inicio_efetivo" name="data_inicio_efetivo" placeholder="DD/MM/AAAA"
                                value="{{ implantacao.data_inicio_efetivo or '' }}">
                            <button class="btn btn-outline-secondary" type="button" id="btn-cal-inicio_efetivo"
                                aria-label="Abrir calendário"><i class="bi bi-calendar3"></i></button>
                        </div>
                    </div>

                    <!-- ID Favorecido -->
                    <div class="mb-3">
                        <label for="modal-id_favorecido" class="form-label fw-bold">
                            <i class="bi bi-hash text-primary me-1"></i>ID Favorecido
                        </label>
                        <input type="text" class="form-control" id="modal-id_favorecido" name="id_favorecido"
                            pattern="[0-9]*" title="Digite apenas números"
                            value="{{ implantacao.id_favorecido or '' }}">
                    </div>

                    <!-- Responsável -->
                    <div class="mb-3">
                        <label for="modal-responsavel_cliente" class="form-label fw-bold">
                            <i class="bi bi-person text-primary me-1"></i>Responsável
                        </label>
                        <input type="text" class="form-control" id="modal-responsavel_cliente"
                            name="responsavel_cliente" maxlength="255"
                            value="{{ implantacao.responsavel_cliente or '' }}">
                    </div>

                    <!-- Contato (Telefone) -->
                    <div class="mb-3">
                        <label for="modal-telefone_responsavel" class="form-label fw-bold">
                            <i class="bi bi-telephone text-primary me-1"></i>Contato
                        </label>
                        <input type="tel" class="form-control" id="modal-telefone_responsavel"
                            name="telefone_responsavel" placeholder="(XX) XXXXX-XXXX" maxlength="15"
                            value="{{ implantacao.telefone_responsavel or '' }}">
                    </div>

                    <!-- Campos ocultos necessários para o backend -->
                    <input type="hidden" id="modal-cargo_responsavel" name="cargo_responsavel" value="">
                    <input type="hidden" id="modal-email_responsavel" name="email_responsavel" value="">
                    <input type="hidden" id="modal-resp_estrategico_nome" name="resp_estrategico_nome" value="">
                    <input type="hidden" id="modal-resp_onb_nome" name="resp_onb_nome" value="">
                    <input type="hidden" id="modal-contatos" name="contatos" value="">
                    <input type="hidden" id="modal-resp_estrategico_obs" name="resp_estrategico_obs" value="">
                    <input type="hidden" id="modal-informacao_infra" name="informacao_infra" value="">
                    <input type="hidden" id="modal-data_cadastro" name="data_cadastro" value="">
                    <input type="hidden" id="modal-data_inicio_producao" name="data_inicio_producao" value="">
                    <input type="hidden" id="modal-data_final_implantacao" name="data_final_implantacao" value="">
                    <input type="hidden" id="modal-nivel_atendimento" name="nivel_atendimento" value="">
                    <input type="hidden" id="modal-valor_monetario" name="valor_monetario" value="">
                    <input type="hidden" id="modal-valor_atribuido" name="valor_atribuido" value="">
                    <input type="hidden" id="modal-cnpj" name="cnpj" value="">
                    <input type="hidden" id="modal-chave_oamd" name="chave_oamd" value="">
                    <input type="hidden" id="modal-tela_apoio_link" name="tela_apoio_link" value="">
                    <input type="hidden" id="modal-seguimento" name="seguimento" value="">
                    <input type="hidden" id="modal-tipos_planos" name="tipos_planos" value="">
                    <input type="hidden" id="modal-modalidades" name="modalidades" value="">
                    <input type="hidden" id="modal-horarios_func" name="horarios_func" value="">
                    <input type="hidden" id="modal-formas_pagamento" name="formas_pagamento" value="">
                    <input type="hidden" id="modal-sistema_anterior" name="sistema_anterior" value="">
                    <input type="hidden" id="modal-recorrencia_usa" name="recorrencia_usa" value="">
                    <input type="hidden" id="modal-diaria" name="diaria" value="">
                    <input type="hidden" id="modal-freepass" name="freepass" value="">
                    <input type="hidden" id="modal-importacao" name="importacao" value="">
                    <input type="hidden" id="modal-boleto" name="boleto" value="">
                    <input type="hidden" id="modal-nota_fiscal" name="nota_fiscal" value="">
                    <input type="hidden" id="modal-alunos_ativos" name="alunos_ativos" value="">
                    <input type="hidden" id="modal-catraca" name="catraca" value="">
                    <input type="hidden" id="modal-modelo_catraca" name="modelo_catraca" value="">
                    <input type="hidden" id="modal-facial" name="facial" value="">
                    <input type="hidden" id="modal-modelo_facial" name="modelo_facial" value="">
                    <input type="hidden" id="modal-wellhub" name="wellhub" value="">
                    <input type="hidden" id="modal-totalpass" name="totalpass" value="">
                </div>
                <div class="modal-footer header-bg">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                    <button type="button" class="btn btn-primary btn-salvar-detalhes"
                        style="background-color: var(--accent-color); border-color: var(--accent-color);">
                        <i class="bi bi-check-lg me-1"></i>Salvar
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>